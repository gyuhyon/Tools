<?xml version="1.0" encoding="ISO-8859-1"?>
<!-- $This file is distributed under the terms of the license in /doc/license.txt$ -->

<!-- See guidelines in vitro/doc/list_view_configuration_guidelines.txt -->

<list-view-config>
    <query-base>    
        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;   
        PREFIX core: &lt;http://vivoweb.org/ontology/core#&gt;
        PREFIX afn:  &lt;http://jena.hpl.hp.com/ARQ/function#&gt;
        
        SELECT DISTINCT ?edTraining ?edTrainingName
                        ?org ?orgName 
                        ?degreeName ?degreeAbbr 
                        ?majorField ?deptOrSchool ?info 
                        ?dateTimeStart ?dateTimeEnd 
            WHERE {
                GRAPH ?g1 { ?subject ?property ?edTraining 
                            LET (?edTrainingName := afn:localname(?edTraining)) 
                }
                OPTIONAL { GRAPH ?g2 { ?edTraining core:trainingAtOrganization ?org }                                   
                           GRAPH ?g3 { ?org rdfs:label ?orgName } 
                }
                OPTIONAL { GRAPH ?g4 { ?edTraining core:degreeEarned ?degree } 
                           OPTIONAL { GRAPH ?g5 { ?degree rdfs:label ?degreeName } }
                           OPTIONAL { GRAPH ?g6 { ?degree core:abbreviation ?degreeAbbr } }
                }
                OPTIONAL { GRAPH ?g7  { ?edTraining core:majorField ?majorField } }
                OPTIONAL { GRAPH ?g8  { ?edTraining core:departmentOrSchool ?deptOrSchool } }
                OPTIONAL { GRAPH ?g9  { ?edTraining core:supplementalInformation ?info } }
                OPTIONAL { GRAPH ?g10 { ?edTraining core:dateTimeInterval ?dateTimeInterval }
                           OPTIONAL { GRAPH ?g11 { ?dateTimeInterval core:start ?dateTimeStartValue }                    
                                      GRAPH ?g12 { ?dateTimeStartValue core:dateTime ?dateTimeStart }
                           }
                           OPTIONAL { GRAPH ?g13 { ?dateTimeInterval core:end ?dateTimeEndValue }   
                                      GRAPH ?g14 { ?dateTimeEndValue core:dateTime ?dateTimeEnd } 
                           }                                       
                }                                  
         }  ORDER BY DESC(?dateTimeEnd) DESC(?dateTimeStart)
    </query-base>

    <query-collated>    
        PREFIX rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;   
        PREFIX core: &lt;http://vivoweb.org/ontology/core#&gt;
        PREFIX afn:  &lt;http://jena.hpl.hp.com/ARQ/function#&gt;
        
        SELECT DISTINCT ?subclass
                        ?edTraining ?edTrainingName
                        ?org ?orgName 
                        ?degreeName ?degreeAbbr 
                        ?majorField ?deptOrSchool ?info 
                        ?dateTimeStart ?dateTimeEnd 
            WHERE {
                GRAPH ?g1 { ?subject ?property ?edTraining 
                            LET (?edTrainingName := afn:localname(?edTraining)) 
                }
                OPTIONAL { GRAPH ?g2 { ?edTraining core:trainingAtOrganization ?org }                                 
                           GRAPH ?g3 { ?org rdfs:label ?orgName } 
                           OPTIONAL { GRAPH ?g4 { ?subclass rdfs:subClassOf core:Organization }
                                      GRAPH ?g5 { ?org a ?subclass } 
                                      FILTER (?g5 != &lt;http://vitro.mannlib.cornell.edu/default/inferred-tbox&gt; &amp;&amp; 
                                              ?g5 != &lt;http://vitro.mannlib.cornell.edu/default/vitro-kb-inf&gt; ) 
                           }                                           
                }
                OPTIONAL { GRAPH ?g6 { ?edTraining core:degreeEarned ?degree } 
                           OPTIONAL { GRAPH ?g7 { ?degree rdfs:label ?degreeName } }
                           OPTIONAL { GRAPH ?g8 { ?degree core:abbreviation ?degreeAbbr } }
                }
                OPTIONAL { GRAPH ?g9  { ?edTraining core:majorField ?majorField } }
                OPTIONAL { GRAPH ?g10 { ?edTraining core:departmentOrSchool ?deptOrSchool } }
                OPTIONAL { GRAPH ?g11 { ?edTraining core:supplementalInformation ?info } }
                OPTIONAL { GRAPH ?g12 { ?edTraining core:dateTimeInterval ?dateTimeInterval }
                           OPTIONAL { GRAPH ?g13 { ?dateTimeInterval core:start ?dateTimeStartValue }                    
                                      GRAPH ?g14 { ?dateTimeStartValue core:dateTime ?dateTimeStart }
                           }
                           OPTIONAL { GRAPH ?g15 { ?dateTimeInterval core:end ?dateTimeEndValue }   
                                      GRAPH ?g16 { ?dateTimeEndValue core:dateTime ?dateTimeEnd } 
                           }                                      
                }                              
         }  ORDER BY ?subclass DESC(?dateTimeEnd) DESC(?dateTimeStart)
    </query-collated>
    
    <template>propStatement-educationalTraining.ftl</template>
</list-view-config>
