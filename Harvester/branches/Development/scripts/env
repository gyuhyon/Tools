#!/bin/bash

#Mysql username, password, and server address for backups in scripts
SERVER=
DBNAME=
USERNAME=
PASSWORD=
VERSION=0.7.1
MIN_MEM=1024m
MAX_MEM=2048M
DATE=`date +%Y-%m-%d_%T`
HARVESTER_TASK="$HARVESTER_TASK.$DATE"
echo "Full Logging in $HARVESTER_TASK.log"

# Check to make sure everything was set by user
if [ "$SERVER" = "" -o "$DBNAME" = "" -o "$USERNAME" = "" -o "$PASSWORD" = "" ]; then
	echo 'Please set variables in env file in the scripts folder before running'
	exit
fi

# Check for backups dir
if [ ! -d backups ]; then
  mkdir backups
fi

# define shorthand aliases
Diff="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=Diff -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.diff.Diff"
D2RMapFetch="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=D2RMapFetch -Dprocess-task=D2RMapFetch -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.fetch.D2RMapFetch"
JDBCFetch="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=JDBCFetch -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.fetch.JDBCFetch"
NIHFetch="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=NIHFetch -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.fetch.NIHFetch"
NLMJournalFetch="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=NLMJournalFetch -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.fetch.NLMJournalFetch"
OAIFetch="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=OAIFetch -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.fetch.OAIFetch"
PubmedFetch="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=PubmedFetch -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.fetch.PubmedFetch"
PubmedHTTPFetch="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=PubmedHTTPFetch -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.fetch.PubmedHTTPFetch"
Qualify="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=Qualify -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.qualify.Qualify"
Score="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=Score -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.score.Score"
Transfer="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=Transfer -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.transfer.Transfer"
GlozeTranslator="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=GlozeTranslator -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.translate.GlozeTranslator"
RDFTranslator="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=RDFTranslator -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.translate.RDFTranslator"
SPARQLTranslator="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=SPARQLTranslator -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.translate.SPARQLTranslator"
XSLTranslator="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=XSLTranslator -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.translate.XSLTranslator"
ChangeNamespace="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=ChangeNamespace -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.qualify.ChangeNamespace"
Update="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=Update -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.update.Update"
DatabaseClone="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=DatabaseClone -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.util.DatabaseClone"
Merge="java -Xms$MIN_MEM -Xmx$MAX_MEM -Dharvester-task=$HARVESTER_TASK -Dprocess-task=Merge -cp bin/harvester-$VERSION.jar:bin/dependency/* org.vivoweb.harvester.util.Merge"